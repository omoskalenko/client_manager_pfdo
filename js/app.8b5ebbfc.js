(function(t){function e(e){for(var r,s,o=e[0],c=e[1],l=e[2],m=0,f=[];m<o.length;m++)s=o[m],n[s]&&f.push(n[s][0]),n[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,o=1;o<a.length;o++){var c=a[o];0!==n[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var r={},n={app:0},i=[];function s(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=r,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(a,r,function(e){return t[e]}.bind(null,r));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/client_manager_pfdo/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"1bcd":function(t,e,a){},"2fc0":function(t,e,a){"use strict";var r=a("1bcd"),n=a.n(r);n.a},"56d7":function(t,e,a){"use strict";a.r(e);var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t.shuldShowNavigation?a("NavBar"):t._e(),t.shuldShowNavigation?a("div",{staticClass:"sidebar",staticStyle:{opacity:"1"}},[a("div",{staticClass:"main-menu"},[a("div",{staticClass:"scroll ps",staticStyle:{height:"327px"}},[a("ul",{staticClass:"list-unstyled"},[a("li",{class:"/"===this.$route.path?"active":""},[a("router-link",{attrs:{to:"/"}},[a("i",{staticClass:"fas fa-search"}),t._v(" Найти сертификат\n          ")])],1),a("li",{class:"/create"===this.$route.path?"active":""},[a("router-link",{attrs:{to:"/create"}},[a("i",{staticClass:"fas fa-plus"}),t._v(" Создать сертификат\n          ")])],1)])])])]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"workspace container"},[a("router-view")],1)])],1)},i=[],s=a("2f62"),o=a("bc3a"),c=a.n(o),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"login_form__wrapper"},[a("div",{staticClass:"error_message",staticStyle:{color:"tomato"}},["error"===t.status?a("p",[t._v(t._s(t.error))]):t._e()]),a("form",[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"poit_of_entry"}},[t._v("Точка входа")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pointOfEntry,expression:"pointOfEntry"}],staticClass:"form-control",attrs:{required:"",type:"text",id:"poit_of_entry",placeholder:"api.example.com"},domProps:{value:t.pointOfEntry},on:{input:function(e){e.target.composing||(t.pointOfEntry=e.target.value)}}}),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.pointOfEntry))])]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"username"}},[t._v("Имя пользователя")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{required:"",type:"text",id:"username",placeholder:"Введите имя пользователя"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.username))])]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"password"}},[t._v("Пароль")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{required:"",type:"password",id:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.username))])]),a("button",{staticClass:"btn btn-primary",on:{click:t.login}},["loading"===t.status?a("div",{staticClass:"text-center"},[t._m(0)]):a("span",[t._v("\n            Войти\n          ")])])])])])])},u=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spinner-border",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[t._v("Loading...")])])}],m=a("a4bb"),f=a.n(m),d={name:"Login",data:function(){return{pointOfEntry:"",username:"",password:"",fieldErrors:{pointOfEntry:void 0,username:void 0,password:void 0}}},computed:{status:function(){return this.$store.getters.status},error:function(){var t=this.$store.getters.errorDetail;return"Cannot read property 'data' of undefined"===t.message?"Некорhектная точка входа":"Неверное имя пользователя или пароль"}},methods:{login:function(t){var e=this;t.preventDefault(),this.fieldErrors=this.validateForm({pointOfEntry:this.pointOfEntry,username:this.username,password:this.password}),f()(this.fieldErrors).length||this.$store.dispatch("login",{pointOfEntry:this.pointOfEntry,username:this.username,password:this.password}).then(function(){return e.$router.push("/")})},validateForm:function(t){var e={};return!t.pointOfEntry&&isPointOfEntry(t.pointOfEntry)&&(e.pointOfEntry="Необходимо указать точку входа"),t.username||(e.username="Введите логин"),t.password||(e.password="Введите пароль"),e},isPointOfEntry:function(t){var e=/(api)?\.[A-z]+\.[A-z]{2,}/;return e.test(t)}}},h=d,v=(a("b6c0"),a("2877")),p=Object(v["a"])(h,l,u,!1,null,"898550f0",null),_=p.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"navbar fixed-top",staticStyle:{opacity:"1"}},[a("div",{staticClass:"logo offset-6"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 261.76     226.69",width:"48",height:"48"}},[a("g",{attrs:{transform:"matrix(1.3333 0 0 -1.3333 -76.311    313.34) "}},[a("g",{attrs:{transform:"translate(178.06 235.01)"}},[a("path",{attrs:{d:"m0    0-22.669-39.264-22.669 39.264h-75.491l98.16-170.02 98.16 170.02z",fill:"#41b883"}})]),a("g",{attrs:{transform:"translate(178.06 235.01)"}},[a("path",{attrs:{d:"m0    0-22.669-39.264-22.669 39.264h-36.227l58.896-102.01 58.896 102.01z",fill:"#34495e"}})])])])]),a("div",{staticClass:"navbar-right"},[a("div",{staticClass:"user d-inline-block"},[t._m(0),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.logout()}}},[t._v("Выход")])])])])},E=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn btn-empty p-0",attrs:{type:"button"}},[a("span",{staticClass:"name"},[t._v("Пользователь")])])}],b={name:"NavBar",methods:{logout:function(){var t=this;this.$store.dispatch("logout").then(function(){return t.$router.push("/login")})}}},y=b,C=(a("2fc0"),Object(v["a"])(y,g,E,!1,null,null,null)),T=C.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"search_box"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"search"},[a("i",{staticClass:"fas fa-search"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],attrs:{type:"text",id:"search",maxlength:"10",pattern:"[0-9]{10}",placeholder:"9905000000"},domProps:{value:t.number},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.seach()},input:function(e){e.target.composing||(t.number=e.target.value)}}}),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.seach()}}},[t._v("Поиск")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"result"},["loading"===t.status?a("div",{staticClass:"text-center"},[t._m(0)]):t._e(),a("p",{directives:[{name:"show",rawName:"v-show",value:t.message,expression:"message"}],staticClass:"message"},[t._v(t._s(t.message))]),t.certificate&&!t.message?a("div",[a("CertificateCard")],1):t._e()])])])},w=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"spinner-border",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[t._v("Loading...")])])}],A=a("cebc"),I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"certificate_card"},[a("div",{staticClass:"indicator",style:t.style}),t.editing?t._e():a("div",{staticClass:"view_data"},[a("h2",[t._v("Сертификат №"+t._s(t.certificate.number))]),a("div",{staticClass:"row"},[a("div",{staticClass:"data"},[a("div",{staticClass:"user_data"},[a("table",[a("tr",{attrs:{align:"left"}},[t._m(0),a("td",[t._v(t._s(t.certificate.name))])]),a("tr",{attrs:{align:"left"}},[t._m(1),a("td",[t._v(t._s(t.certificate.soname))])]),a("tr",{attrs:{align:"left"}},[t._m(2),a("td",[t._v(t._s(t.certificate.phname))])])])]),a("div",{staticClass:"certificate_data"},[a("table",[a("tr",{attrs:{align:"left"}},[t._m(3),a("td",[t._v(t._s(t.certificate.actual?"Сертификат активирован":"Сертификат не активирован"))])]),a("tr",{attrs:{align:"left"}},[t._m(4),a("td",[t._v(t._s(t.certificate.cert_group_name))])]),t._m(5)])])])]),a("div",{staticClass:"row"},[t.editing?t._e():a("div",{staticClass:"button_group offset-4"},[a("button",{staticClass:"btn btn-outline-dark",attrs:{type:"button"},on:{click:function(e){return t.edit()}}},[t._v("\n          Редактировать\n        ")]),a("button",{staticClass:"btn btn-outline-dark",attrs:{type:"button",disabled:t.isActiveted},on:{click:function(e){return t.activate(t.certificate.number)}}},[t._v("\n          Активировать\n        ")]),a("button",{directives:[{name:"show",rawName:"v-show",value:!t.isActiveted,expression:"!isActiveted"}],staticClass:"btn btn-outline-dark",attrs:{type:"button"},on:{click:function(e){return t.deleteCertificate(t.certificate.number)}}},[t._v("Удалить")])])])]),t.editing?a("div",{staticClass:"edit_data"},[a("form",{staticClass:"ui form",on:{submit:t.save}},[a("div",{staticClass:"field"},[a("table",[a("tr",[t._m(6),a("td",[a("input",{attrs:{type:"text",name:"name"},domProps:{value:t.certificate.name}})]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.name))])]),a("tr",[t._m(7),a("td",[a("input",{attrs:{type:"text",name:"soname"},domProps:{value:t.certificate.soname}})]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.soname))])]),a("tr",[t._m(8),a("td",[a("input",{attrs:{type:"text",name:"phname"},domProps:{value:t.certificate.phname}})]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.phname))])]),a("tr",[t._m(9),t._m(10),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.birthday))])]),a("tr",[t._m(11),t._m(12),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.email))])])])]),a("button",{staticClass:"btn btn-outline-dark"},[t._v("Сохранить")])])]):t._e()])},O=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{width:"150"}},[a("strong",[t._v("Имя:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("strong",[t._v("Фамилия:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("strong",[t._v("Отчество:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{width:"150"}},[a("strong",[t._v("Статус:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("strong",[t._v("Группа:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{attrs:{align:"left"}},[a("td",[a("strong",[t._v("-")])]),a("td",[t._v("-")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"name"}},[t._v("Имя")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"soname"}},[t._v("Фамилия")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"phname"}},[t._v("Отчество")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"birthday"}},[t._v("Дата рождения")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("input",{attrs:{type:"text",name:"birthday",placeholder:"ДД.ММ.ГГГ"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"email"}},[t._v("E-mail")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("input",{attrs:{type:"text",name:"email",placeholder:"example@example.com"}})])}],R=(a("4917"),a("28a5"),a("7f7f"),{name:"CertificateCard",data:function(){return{editing:!1,fieldErrors:{name:"",soname:"",phname:"",birthday:"",email:""}}},computed:{certificate:function(){return this.$store.getters.certificate},isActiveted:function(){return 1==this.certificate.actual},style:function(){return this.isActiveted?"background-color: green":"background-color: tomato"}},methods:{activate:function(t){var e=this;this.$store.dispatch("activateCertificate",t).then(function(t){e.$store.dispatch("getCertificate","".concat(e.certificate.number)).then(function(){e.isActiveted||e.$store.commit("UPDATE_CERTIFICATE",{actual:1})})})},edit:function(){this.editing=!0},save:function(t){var e=this;t.preventDefault();var a={name:t.target.name.value,soname:t.target.soname.value,phname:t.target.phname.value,birthday:t.target.birthday.value,email:t.target.email.value};this.fieldErrors=this.validateForm(a),f()(this.fieldErrors).length||this.$store.dispatch("editCertificate",{number:this.certificate.number,data:a}).then(function(){e.$store.commit("UPDATE_CERTIFICATE",a),e.editing=!1})},deleteCertificate:function(t){var e=this;this.$store.dispatch("deleteCertificate",t).then(function(){e.$store.commit("DELETE_CERTIFICATE")})},validateForm:function(t){var e={};return this.isValidName(t.name)||(e.name="Имя должно состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidSoname(t.soname)||(e.soname="Фамилия должна состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidPhname(t.phname)||(e.phname="Отчество должно состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidBirthday(t.birthday)||(e.birthday="Проверьте корректность введенной даты. Дата рождения должна быть в формате ДД.ММ.ГГГГ, год рождения от 1998"),this.isValidEmail(t.email)||(e.email="Обязательное поле. Адрес электронной почты: ограничение в 255 символов"),e},isValidName:function(t){var e=/^[а-яА-ЯёЁ]+([-]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidSoname:function(t){var e=/^[а-яА-ЯёЁ]+([ -]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidPhname:function(t){var e=/^[а-яА-ЯёЁ]+([ -]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidEmail:function(t){var e=/^[А-яёЁa-zA-Z0-9!#$%&'*+\\\/=?^_`{|}~-]+(?:\.[А-яёЁa-zA-Z0-9!#$%&'*+\\\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9А-яёЁ](?:[a-zA-Z0-9-А-яёЁ]*[a-zA-Z0-9А-яёЁ])?\.)+[a-zA-Z0-9А-яёЁ](?:[a-zA-Z0-9-А-яёЁ]*[a-zA-Z0-9А-яёЁ])?$/;return e.test(t)},isValidBirthday:function(t){var e=/^([0-9]{2})\.([0-9]{2})\.([0-9]{4})$/;function a(t){var e=t.split("."),a=new Date(e[2]+"/"+e[1]+"/"+e[0]);return e[2]==a.getFullYear()&&e[1]==a.getMonth()+1&&e[0]==a.getDate()}return e.test(t)&&t.match(e)[3]>=1998&&t.match(e)[1]>=1&&t.match(e)[1]<=31&&t.match(e)[2]>=1&&t.match(e)[2]<=12&&a(t)}}}),$=R,k=(a("666d"),Object(v["a"])($,I,O,!1,null,"46a11fb0",null)),x=k.exports,U={name:"SearchBox",components:{CertificateCard:x},data:function(){return{number:"",message:""}},computed:Object(A["a"])({},Object(s["b"])(["certificate","status"])),methods:{seach:function(){var t=this;return this.message="",!!this.number&&(/[0-9]{10}/.test(this.number)?void this.$store.dispatch("getCertificate",this.number).then(function(e){"Запись не найдена"!==e.result_message||(t.message="Запись не найдена")}):this.message="Номер не должен быть короче 10 символов и должен состоять только из цифр")}}},N=U,P=(a("d1fe"),Object(v["a"])(N,S,w,!1,null,null,null)),F=P.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create_certificate"},[t.create?a("h2",[t._v("Сертификат №"+t._s(t.setNumber)+" создан")]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.create,expression:"!create"}],staticClass:"certificate_card"},[a("h2",[t._v("Новый сертификат")]),a("form",{staticClass:"ui form",on:{submit:t.save}},[a("div",{staticClass:"field"},[a("table",[a("tr",[a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"number"}},[t._v("Номер")]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.error_message,expression:"error_message"}]},[t._v(t._s(t.error_message))])]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],attrs:{type:"text",name:"number",disabled:""},domProps:{value:t.number},on:{input:function(e){e.target.composing||(t.number=e.target.value)}}})])]),a("tr",[t._m(0),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",name:"name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})])]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.name))]),a("tr",[t._m(1),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.soname,expression:"soname"}],attrs:{type:"text",name:"soname"},domProps:{value:t.soname},on:{input:function(e){e.target.composing||(t.soname=e.target.value)}}})])]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.soname))]),a("tr",[t._m(2),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phname,expression:"phname"}],attrs:{type:"text",name:"phname"},domProps:{value:t.phname},on:{input:function(e){e.target.composing||(t.phname=e.target.value)}}})])]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.phname))]),a("tr",[t._m(3),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.birthday,expression:"birthday"}],attrs:{type:"text",name:"birthday",placeholder:"ДД.ММ.ГГГ"},domProps:{value:t.birthday},on:{input:function(e){e.target.composing||(t.birthday=e.target.value)}}})])]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.birthday))]),a("tr",[t._m(4),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",name:"email",placeholder:"example@example.com"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})])]),a("span",{staticStyle:{color:"tomato"}},[t._v(t._s(t.fieldErrors.email))])])]),a("button",{staticClass:"btn btn-outline-dark"},[t._v("Сохранить")])])]),a("div",{staticClass:"history"},[a("h2",[t._v("История")]),a("hr"),a("ul",t._l(t.history,function(e){return a("li",{key:e},[t._v(t._s(e))])}),0)])])},j=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"name"}},[t._v("Имя")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"soname"}},[t._v("Фамилия")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"phname"}},[t._v("Отчество")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"birthday"}},[t._v("Дата рождения")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{align:"left"}},[a("label",{attrs:{for:"email"}},[t._v("E-mail")])])}],z={name:"CreateForm",components:{CertificateCard:x},data:function(){return{name:"",soname:"",phname:"",birthday:"",email:"",create:!1,error_message:"",setNumber:"",fieldErrors:{name:void 0,soname:void 0,phname:void 0,birthday:void 0,email:void 0}}},computed:{number:function(){return"9905".concat(Math.floor(899999*Math.random())+1e5)},history:function(){return this.$store.getters.history}},methods:{save:function(t){var e=this;t.preventDefault();var a={number:t.target.number.value,name:t.target.name.value,soname:t.target.soname.value,phname:t.target.phname.value,birthday:t.target.birthday.value,messages_email:t.target.email.value};this.fieldErrors=this.validateForm(a),f()(this.fieldErrors).length||this.$store.dispatch("createCertificate",a).then(function(t){e.toogleState(),e.setNumber=t.data.number,setTimeout(function(){e.resetForm(),e.$router.push("/")},1e3)}).catch(function(t){e.error_message=t})},resetForm:function(){this.toogleState(),this.name="",this.soname="",this.phname="",this.birthday="",this.email="",this.error_message=""},toogleState:function(){this.create=!this.create},validateForm:function(t){var e={};return this.isValidName(t.name)||(e.name="Имя должно состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidSoname(t.soname)||(e.soname="Фамилия должна состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidPhname(t.phname)||(e.phname="Отчество должно состоятьиз букв русского алфавита и не превышать 60 символов"),this.isValidBirthday(t.birthday)||(e.birthday="Проверьте корректность введенной даты. Дата рождения должна быть в формате ДД.ММ.ГГГГ, год рождения от 1998"),this.isValidEmail(t.messages_email)||(e.email="Обязательное поле. Адрес электронной почты: ограничение в 255 символов"),e},isValidName:function(t){var e=/^[а-яА-ЯёЁ]+([-]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidSoname:function(t){var e=/^[а-яА-ЯёЁ]+([ -]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidPhname:function(t){var e=/^[а-яА-ЯёЁ]+([ -]{1}[а-яА-ЯёЁ]+){0,3}$/;return e.test(t)},isValidEmail:function(t){var e=/^[А-яёЁa-zA-Z0-9!#$%&'*+\\\/=?^_`{|}~-]+(?:\.[А-яёЁa-zA-Z0-9!#$%&'*+\\\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9А-яёЁ](?:[a-zA-Z0-9-А-яёЁ]*[a-zA-Z0-9А-яёЁ])?\.)+[a-zA-Z0-9А-яёЁ](?:[a-zA-Z0-9-А-яёЁ]*[a-zA-Z0-9А-яёЁ])?$/;return e.test(t)},isValidBirthday:function(t){var e=/^([0-9]{2})\.([0-9]{2})\.([0-9]{4})$/;function a(t){var e=t.split("."),a=new Date(e[2]+"/"+e[1]+"/"+e[0]);return e[2]==a.getFullYear()&&e[1]==a.getMonth()+1&&e[0]==a.getDate()}return e.test(t)&&t.match(e)[3]>=1998&&t.match(e)[1]>=1&&t.match(e)[1]<=31&&t.match(e)[2]>=1&&t.match(e)[2]<=12&&a(t)}}},D=z,B=(a("7808"),Object(v["a"])(D,V,j,!1,null,null,null)),H=B.exports,L={components:{Login:_,NavBar:T,SearchBox:F,Create:H},created:function(){this.$store.dispatch("readHistory",localStorage.getItem("createHistory")),localStorage.getItem("access_token")&&this.$store.commit("AUTH_SUCCESS")},computed:{history:function(){return this.$store.getters.history},shuldShowNavigation:function(){return"/login"!==this.$route.path}}},Z=L,G=(a("5c0b"),Object(v["a"])(Z,n,i,!1,null,null,null)),M=G.exports,Q=a("8c4f"),q=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"message_box"},[a("p",[t._v("Страница не существует =(")])])])])}],J=(a("fe0d"),{}),K=Object(v["a"])(J,q,Y,!1,null,null,null),W=K.exports;r["a"].use(Q["a"]);var X=new Q["a"]({mode:"history",routes:[{path:"/login",component:_,beforeEnter:function(t,e,a){var r=localStorage.getItem("access_token");r?a("/"):a()}},{path:"/",component:F},{path:"/create",component:H},{path:"*",component:W}]});X.beforeEach(function(t,e,a){var r=localStorage.getItem("access_token");r||"/login"===t.path?a():a("/login")});var tt=X,et=a("795b"),at=a.n(et),rt=a("f499"),nt=a.n(rt),it=a("d225"),st=a("b0b4"),ot=function(){function t(e){Object(it["a"])(this,t),this._ORIGIN=localStorage.getItem("point_of_entry"),this._ROUTES=e,this._token=localStorage.getItem("access_token"),this._refresh_token=localStorage.getItem("refresh_token"),this._initAxios()}return Object(st["a"])(t,[{key:"_initAxios",value:function(){var t=this;c.a.defaults.headers.common["Content-Type"]="application/json",this.token&&(c.a.defaults.headers.common["Authorization"]="Bearer ".concat(this.token)),c.a.interceptors.response.use(function(t){return t},function(e){var a=e.response?e.response.status:null,r=e.config;if(401===a)return t.refreshToken().then(function(){return r.headers["Authorization"]="Bearer ".concat(t.token),c.a.request(r)});if(400===a)throw e.response.data})}},{key:"refreshToken",value:function(){var t=this;return c()({method:"POST",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.AUTH),data:{grant_type:"refresh_token",refresh_token:this._refresh_token,client_id:"candidate_app",client_secret:"vuejsispower"}}).then(function(e){for(var a in t.token=e.data.access_token,t._refresh_token=e.data.refresh_token,e.data)localStorage.setItem(a,e.data[a]);return c.a.defaults.headers.common["Authorization"]="Bearer ".concat(t.token),new at.a(function(t){t(e)})}).catch(function(t){throw t})}},{key:"initPointOfEntry",value:function(t){this._ORIGIN="https://".concat(t)}},{key:"login",value:function(t){var e=this,a=t.username,r=t.password;if(!localStorage.getItem("access_token"))return c()({method:"POST",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.AUTH),data:{grant_type:"password",username:a,password:r,client_id:"candidate_app",client_secret:"vuejsispower"}}).then(function(t){for(var a in e.token=t.data.access_token,e._refresh_token=t.data.refresh_token,c.a.defaults.headers.common["Authorization"]="Bearer ".concat(e.token),t.data)localStorage.setItem(a,t.data[a]);return localStorage.setItem("point_of_entry",e._ORIGIN),new at.a(function(e){e(t)})})}},{key:"getCertificate",value:function(t){return c()({method:"GET",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.REQ_SERTIFICATE(t))})}},{key:"createCertificate",value:function(t){return c()({method:"POST",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.CREATE_SERTIFICATE),data:t})}},{key:"activateCertificate",value:function(t){return c()({method:"PUT",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.ACTIVATE_SERTIFICATE(t)),data:nt()({actual:1})})}},{key:"editCertificate",value:function(t){var e=t.number,a=t.data;return c()({method:"PATCH",headers:{"Content-Type":"application/json"},baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.EDITING_SERTIFICATE(e)),data:nt()(a)}).catch(function(t){return console.log(t)})}},{key:"deleteCertificate",value:function(t){return c()({method:"DELETE",baseURL:"".concat(this._ORIGIN).concat(this._ROUTES.REQ_SERTIFICATE(t))}).catch(function(t){return console.error(t)})}}]),t}(),ct={AUTH:"/oauth2/token",CREATE_SERTIFICATE:"/v2/certificates",REQ_SERTIFICATE:function(t){return"/v2/certificates/".concat(t)},ACTIVATE_SERTIFICATE:function(t){return"".concat(this.REQ_SERTIFICATE(t),"/actual")},EDITING_SERTIFICATE:function(t){return"".concat(this.REQ_SERTIFICATE(t),"/personal")}},lt=new ot(ct),ut=lt,mt={interval:30,status:null,errorDetail:null,refreshTimer:null,isAutorized:!1},ft={AUTH_SUCCESS:function(t){t.status="success",t.refreshTimer=setInterval(function(){return ut.refreshToken()},60*t.interval*1e3)},AUTH_ERROR:function(t,e){t.status="error",t.errorDetail=e},SET_STATUS:function(t,e){t.status=e},LOGOUT:function(t,e){t.status=e?"error":null}},dt={login:function(t,e){var a=t.commit,r=e.pointOfEntry,n=e.username,i=e.password;return a("SET_STATUS","loading"),ut.initPointOfEntry(r),ut.login({username:n,password:i}).then(function(t){a("AUTH_SUCCESS",t.data)}).catch(function(t){a("AUTH_ERROR",t)})},logout:function(t,e){var a=t.commit;return new at.a(function(t){localStorage.clear(),a("LOGOUT",e),a("DELETE_CERTIFICATE","success"),t()})}},ht={status:function(t){return t.status},errorDetail:function(t){return t.errorDetail}},vt={state:mt,mutations:ft,actions:dt,getters:ht},pt=vt,_t={certificate:null},gt={SAVE_CERTIFICATE:function(t,e){t.certificate=e},UPDATE_CERTIFICATE:function(t,e){for(var a in e)t.certificate[a]=e[a]},DELETE_CERTIFICATE:function(t){t.certificate=null}},Et={getCertificate:function(t,e){var a=t.commit;return a("SET_STATUS","loading"),ut.getCertificate(e).then(function(t){return a("SET_STATUS","success"),a("SAVE_CERTIFICATE",Object(A["a"])({},t.data.data)),new at.a(function(e){e(t.data)})}).catch(function(t){return a("SET_STATUS","error"),a("AUTH_ERROR",t),new at.a(function(e,a){a(t)})})}},bt={certificate:function(t){return t.certificate}},yt={state:_t,mutations:gt,actions:Et,getters:bt},Ct=yt,Tt={data:{name:"",soname:"",phname:"",birthday:"",email:""}},St={UPDATA_DATA:function(t,e){t.data=e}},wt={activateCertificate:function(t,e){ut.activateCertificate(e)},editCertificate:function(t,e){ut.editCertificate(e)},deleteCertificate:function(t,e){ut.deleteCertificate(e)}},At={data:function(t){return t.data},name:function(t){return t.data.name},soname:function(t){return t.data.soname},phname:function(t){return t.data.phname},birthday:function(t){return t.data.birthday},email:function(t){return t.data.email}},It={state:Tt,mutations:St,actions:wt,getters:At},Ot=It,Rt={history:[]},$t={SAVE_NUMBER:function(t,e){t.history.push(e),localStorage.setItem("createHistory",t.history.join(","))},READ_HISTORY:function(t,e){t.history=e.split(",")}},kt={createCertificate:function(t,e){var a=t.commit;return a("SET_STATUS","loading"),ut.createCertificate(e).then(function(t){return t.data.data.actual?(a("SAVE_NUMBER",t.data.data.number),a("SET_STATUS","success"),a("SAVE_CERTIFICATE",t.data.data),new at.a(function(e){e(t.data)})):new at.a(function(e,a){a(t.data.data.number[0])})}).catch(function(t){return a("SET_STATUS","error"),a("AUTH_ERROR",t),new at.a(function(e,a){a(t)})})},readHistory:function(t,e){var a=t.commit;a("READ_HISTORY",e)}},xt={history:function(t){return t.history}},Ut={state:Rt,mutations:$t,actions:kt,getters:xt},Nt=Ut;r["a"].use(s["a"]);var Pt=new s["a"].Store({modules:{auth:pt,searchBox:Ct,certificateCard:Ot,createCertificate:Nt}});r["a"].config.productionTip=!1,new r["a"]({router:tt,store:Pt,render:function(t){return t(M)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var r=a("5e27"),n=a.n(r);n.a},"5e27":function(t,e,a){},6585:function(t,e,a){},"666d":function(t,e,a){"use strict";var r=a("8438"),n=a.n(r);n.a},7808:function(t,e,a){"use strict";var r=a("6585"),n=a.n(r);n.a},8438:function(t,e,a){},b6c0:function(t,e,a){"use strict";var r=a("f7f3"),n=a.n(r);n.a},d1fe:function(t,e,a){"use strict";var r=a("d274"),n=a.n(r);n.a},d274:function(t,e,a){},eeaa:function(t,e,a){},f7f3:function(t,e,a){},fe0d:function(t,e,a){"use strict";var r=a("eeaa"),n=a.n(r);n.a}});
//# sourceMappingURL=app.8b5ebbfc.js.map